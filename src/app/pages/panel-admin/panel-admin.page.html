<ion-header [translucent]="true">
  <ion-toolbar class="header">
    <ion-buttons slot="start">
      <ion-icon name="arrow-back-outline" size="large" routerLink="/perfil" color="primary"></ion-icon>
    </ion-buttons>
    <ion-title color="primary">Gestionar mi Local</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <form [formGroup]="localForm" (ngSubmit)="onSubmit()">
    <div class="cover-container">
      <img *ngIf="localForm.value.imagen" [src]="localForm.value.imagen" alt="Portada" class="cover-img"/>
      <ion-button expand="block" shape="round" (click)="toggleCoverInput()" class="gradient-button">
        {{localForm.value.imagen ? 'Cambiar Portada' : 'Agregar Portada'}}
      </ion-button>
      <ion-input *ngIf="showCoverInput" formControlName="imagen" placeholder="URL de la imagen"></ion-input>
    </div>

    <ion-item>
      <ion-label position="floating">Nombre del Establecimiento</ion-label>
      <ion-input formControlName="nombre"></ion-input>
      <ion-note *ngIf="localForm.get('nombre')?.errors?.['required'] && localForm.get('nombre')?.touched" color="danger">
        Este campo es requerido
      </ion-note>
    </ion-item>

    <ion-item>
      <ion-label position="floating">Dirección</ion-label>
      <ion-input formControlName="direccion"></ion-input>
      <ion-note *ngIf="localForm.get('direccion')?.errors?.['required'] && localForm.get('direccion')?.touched" color="danger">
        Este campo es requerido
      </ion-note>
    </ion-item>

    <ion-item>
      <ion-label position="floating">Horario de Apertura (HH:MM)</ion-label>
      <ion-input formControlName="horarioApertura" placeholder="Ej: 08:00"></ion-input>
      <ion-note *ngIf="localForm.get('horarioApertura')?.errors?.['invalidHora']" color="danger">
        Formato inválido (use HH:MM)
      </ion-note>
    </ion-item>

    <ion-item>
      <ion-label position="floating">Horario de Cierre (HH:MM)</ion-label>
      <ion-input formControlName="horarioCierre" placeholder="Ej: 22:00"></ion-input>
      <ion-note *ngIf="localForm.get('horarioCierre')?.errors?.['invalidHora']" color="danger">
        Formato inválido (use HH:MM)
      </ion-note>
    </ion-item>

    <ion-item>
      <ion-label position="floating">Días de Atención (separados por comas)</ion-label>
      <ion-input formControlName="dias" placeholder="Ej: Lunes,Martes,Miércoles"></ion-input>
      <ion-note *ngIf="localForm.get('dias')?.errors?.['required'] && localForm.get('dias')?.touched" color="danger">
        Este campo es requerido
      </ion-note>
    </ion-item>

    <ion-item>
      <ion-label position="floating">Tipo de Establecimiento</ion-label>
      <ion-input formControlName="tipo"></ion-input>
      <ion-note *ngIf="localForm.get('tipo')?.errors?.['required'] && localForm.get('tipo')?.touched" color="danger">
        Este campo es requerido
      </ion-note>
    </ion-item>

    <ion-item>
      <ion-label position="floating">Latitud</ion-label>
      <ion-input formControlName="lat" type="number"></ion-input>
      <ion-note *ngIf="localForm.get('lat')?.errors?.['required'] && localForm.get('lat')?.touched" color="danger">
        Este campo es requerido
      </ion-note>
    </ion-item>

    <ion-item>
      <ion-label position="floating">Longitud</ion-label>
      <ion-input formControlName="lng" type="number"></ion-input>
      <ion-note *ngIf="localForm.get('lng')?.errors?.['required'] && localForm.get('lng')?.touched" color="danger">
        Este campo es requerido
      </ion-note>
    </ion-item>

    <div class="Etiquetas">
      <h4>Etiquetas del Local</h4>
      <p>Usa etiquetas para que tu negocio sea más fácil de encontrar</p>
      <div class="chips-row">
        <ion-chip color="secondary">
          <ion-icon name="restaurant" color="secondary"></ion-icon>
          <ion-label>Tipo de Comida</ion-label>
          <ion-icon name="caret-down-outline" color="secondary"></ion-icon>
        </ion-chip>
        
        <ion-chip color="secondary">
          <ion-icon name="card" color="secondary"></ion-icon>
          <ion-label>Tipos de Pago</ion-label>
          <ion-icon name="caret-down-outline" color="secondary"></ion-icon>
        </ion-chip>

        <ion-chip color="secondary">
          <ion-icon name="cash" color="secondary"></ion-icon>
          <ion-label>Rango de Precios</ion-label>
          <ion-icon name="caret-down-outline" color="secondary"></ion-icon>
        </ion-chip>
      </div>
    </div>

    <ion-item lines="strong" color="translucent">
      <ion-label class="ion-text-wrap">
        <h3>Gestionar Menú</h3>
      </ion-label>
      <ion-icon slot="end" name="chevron-up-outline" color="secondary"></ion-icon>
    </ion-item>

    <ion-item lines="strong" color="translucent" button [routerLink]="'/aniadir-menu'">
      <ion-label color="primary">Añadir elementos al Menú</ion-label>
      <ion-icon name="chevron-forward-outline" slot="end" class="option-icon" color="primary"></ion-icon>
    </ion-item>
    <ion-item lines="strong" color="translucent" button>
      <ion-label color="primary">Editar el Menú</ion-label>
      <ion-icon name="chevron-forward-outline" slot="end" class="option-icon" color="primary"></ion-icon>
    </ion-item>
    <ion-item lines="strong" color="translucent" button>
      <ion-label color="primary">Ubicación en el Mapa</ion-label>
      <ion-icon name="chevron-forward-outline" slot="end" class="option-icon" color="primary"></ion-icon>
    </ion-item>
    <ion-item lines="strong" color="translucent" button>
      <ion-label color="primary">Gestionar Reseñas</ion-label>
      <ion-icon name="chevron-forward-outline" slot="end" class="option-icon" color="primary"></ion-icon>
    </ion-item>
    <ion-item lines="strong" color="translucent" button>
      <ion-label color="primary">Gestionar Publicidad</ion-label>
      <ion-icon name="chevron-forward-outline" slot="end" class="option-icon" color="primary"></ion-icon>
    </ion-item>
    <ion-item lines="strong" color="translucent" button>
      <ion-label color="primary">Cargar fotos del local</ion-label>
      <ion-icon name="chevron-forward-outline" slot="end" class="option-icon" color="primary"></ion-icon>
    </ion-item>

    <div class="cover-container">
      <ion-button
        expand="block"
        shape="round"
        type="submit"
        [disabled]="isSubmitting || localForm.invalid"
        class="gradient-button"
      >
        Guardar Cambios
      </ion-button>
    </div>
  </form>
</ion-content>