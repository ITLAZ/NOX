<toolbar [pageTitle]="'Iniciar sesión'" [showCart]="false" [showSearch]="false" [showNotifications]="false" [showBack]="true" [setRoute]="'/start'" [toolColor]="'var(--ion-color-dark)'" [setColor]="'var(--ion-color-primary)'"></toolbar>

<ion-content [fullscreen]="true" class="login-content">
  <ion-grid>
    <ion-row class="ion-justify-content-center">
      <ion-col size="12" size-md="8" size-lg="6">
        <form [formGroup]="form" (ngSubmit)="login()">
          <div class="login-logo">
            <img src="assets/images/NOX.png" alt="NOX logo" />
          </div>
          <!-- Usuario -->
          <ion-item class="custom-item">
            <ion-label position="floating">
              <ion-text color="secondary">Nombre de usuario</ion-text>
            </ion-label>
            <ion-input formControlName="username" type="text"></ion-input>
          </ion-item>
          <ion-text color="danger" *ngIf="form.get('username')?.touched && form.get('username')?.invalid">
            <p *ngIf="form.get('username')?.errors?.['required']">El nombre de usuario es requerido</p>
          </ion-text>

          <!-- Contraseña -->
          <ion-item class="custom-item">
            <ion-label position="floating">
              <ion-text color="secondary">Contraseña</ion-text>
            </ion-label>
            <ion-input formControlName="password" type="password"></ion-input>
          </ion-item>
          <ion-text color="danger" *ngIf="form.get('password')?.touched && form.get('password')?.invalid">
            <p *ngIf="form.get('password')?.errors?.['required']">La contraseña es requerida</p>
          </ion-text>

          <!-- Helper text solo si hay error general -->
          <ion-text color="danger" *ngIf="form.invalid && (form.get('username')?.touched || form.get('password')?.touched)">
            <p>Por favor completa los campos requeridos.</p>
          </ion-text>

          <!-- Enlaces adicionales -->
          <ion-row class="login-links">
            <ion-col size="12" class="text-left">
              <ion-text color="secondary" class="mini" style="color: var(--ion-color-secondary); text-decoration: underline;">
                <p>Me olvidé mi usuario o contraseña</p>
              </ion-text>
            </ion-col>
            <ion-col size="12" class="text-left">
              <ion-text color="secondary" class="mini">
                <a routerLink="/registro" style="color: var(--ion-color-secondary); text-decoration: underline;">
                  ¿No tienes una cuenta? Regístrate
                </a>
              </ion-text>
            </ion-col>
          </ion-row>

          <!-- Botón -->
          <ion-button expand="block" color="gradient" type="submit">
            Iniciar sesión
          </ion-button>

          <!-- Botón Google -->
          <ion-button expand="block" color="gradient" (click)="loginWithGoogle()" type="button">
            <ion-icon name="logo-google" slot="start"></ion-icon>
            Iniciar sesión con Google
          </ion-button>
        </form>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
