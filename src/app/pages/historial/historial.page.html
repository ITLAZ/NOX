<toolbar [pageTitle]="'Historial'" [showSearch]="false" [showCart]="false" [showNotifications]="false" [showBack]="true" (click)="navigateBack()"></toolbar>

<ion-content [fullscreen]="true" class="historial-content">

  <!-- Tabs -->
  <ion-segment [(ngModel)]="activeTab" color="success" class="historial-tabs">
    <ion-segment-button value="lugares">
      <ion-label>Lugares</ion-label>
    </ion-segment-button>
    <ion-segment-button value="eventos">
      <ion-label>Eventos</ion-label>
    </ion-segment-button>
  </ion-segment>

  <!-- Contenido: Lugares -->
  <ng-container *ngIf="activeTab === 'lugares'">
    <ion-text color="success" class="subtitle">
      <h2 class="section-title">Lugares visitados recientemente</h2>
    </ion-text>
    <swiper-container slides-per-view="1.2" space-between="10" navigation="false" pagination="false" class="historial-swiper" style="width: 375px; height: 350px;">
      <swiper-slide *ngFor="let lugar of historialLocales">
        <mid-card 
          [nombre]="lugar.nombreLocal"
          [imagen]="lugar.imagen || 'assets/img/default-local.jpg'"
          [tipo]="lugar.tipo || 'Local'"
          [etiquetas]="lugar.etiquetas || []"
          [direccion]="lugar.direccion || 'DirecciÃ³n no disponible'"
          [distancia]="lugar.distancia || 'Desconocida'"
          [calificacion]="lugar.calificacion || 0">
        </mid-card>
      </swiper-slide>
    </swiper-container>

    <ion-text color="success" class="subtitle">
      <h2 class="section-title">Historial de compra</h2>
    </ion-text>
    <ion-list>
      <ion-list-header>Historial de Compras - Locales</ion-list-header>
      <ion-item *ngFor="let item of historialLocales">
        <ion-label>
          <h2>{{ item.nombreLocal }}</h2>
          <p>{{ item.fechaCompra?.toDate() | date }}</p>
          <p>{{ item.total }} ARS</p>
        </ion-label>
      </ion-item>
    </ion-list>
  </ng-container>

  <!-- Contenido: Eventos -->
  <ng-container *ngIf="activeTab === 'eventos'">
    <ion-text color="success" class="subtitle">
      <h2 class="section-title">Eventos visitados recientemente</h2>
    </ion-text>
    <swiper-container slides-per-view="1.2" space-between="10" navigation="false" pagination="false" class="historial-swiper" style="width: 375px; height: 350px;">
      <swiper-slide *ngFor="let evento of historialEventos">
        <mid-card
          [nombre]="evento.nombreEvento"
          [imagen]="evento.imagen || 'assets/img/default-evento.jpg'"
          [tipo]="evento.tipo || 'Evento'"
          [etiquetas]="evento.etiquetas || []"
          [direccion]="evento.direccion || 'Lugar no especificado'"
          [fecha]="evento.fecha || 'Sin fecha'"
          [calificacion]="evento.calificacion || 0">
        </mid-card>
      </swiper-slide>
    </swiper-container>

    <ion-text color="success" class="subtitle">
      <h2 class="section-title">Historial de eventos</h2>
    </ion-text>
    <ion-list>
      <ion-list-header>Historial de Compras - Eventos</ion-list-header>
      <ion-item *ngFor="let item of historialEventos">
        <ion-label>
          <h2>{{ item.nombreEvento }}</h2>
          <p>{{ item.fechaCompra?.toDate() | date }}</p>
          <p>{{ item.total }} ARS</p>
        </ion-label>
      </ion-item>
    </ion-list>
  </ng-container>

</ion-content>
